

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Snap Flow Builder &mdash; Dungeon Architect [Unity]  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Grid Builder" href="builder_grid.html" />
    <link rel="prev" title="Grid Flow Builder" href="builder_grid_flow.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Dungeon Architect [Unity]
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="create_first_dungeon.html">Create your first Dungeon</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_first_theme.html">Design your first theme</a></li>
<li class="toctree-l1"><a class="reference internal" href="launch_pad.html">Launch Pad Window</a></li>
<li class="toctree-l1"><a class="reference internal" href="builder_grid_flow.html">Grid Flow Builder</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Snap Flow Builder</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#preparing-the-scene">Preparing the Scene</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-module-prefabs">Creating Module Prefabs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#connections">Connections</a></li>
<li class="toctree-l2"><a class="reference internal" href="#register-the-modules">Register the Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dungeon-flow">Dungeon Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="#generating-the-dungeon">Generating the Dungeon</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="builder_grid.html">Grid Builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_theming.html">Advanced Theming</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_dungeon_concepts.html">Advanced Dungeons</a></li>
</ul>
<p class="caption"><span class="caption-text">MORE BUILDERS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="builder_simple_city.html">Simple City Builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="builder_mario.html">Mario Builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="builder_infinity_cave.html">Infinity Caves Builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="builder_bsp.html">Spatial Partition Builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="builder_floor_plan.html">Floor Plan Builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="builder_circular_city.html">Circular City Builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="builder_isaac.html">Isaac Builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="builder_maze.html">Maze Builder</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Dungeon Architect [Unity]</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Snap Flow Builder</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="snap-flow-builder">
<h1>Snap Flow Builder<a class="headerlink" href="#snap-flow-builder" title="Permalink to this headline">¶</a></h1>
<p>The Snap Builder generates a dungeon by stitching together pre-built rooms prefabs.   The rules for stitching them is controlled by Graph Grammars</p>
<p>In this page, we’ll walk through the creation process.</p>
<div class="section" id="preparing-the-scene">
<h2>Preparing the Scene<a class="headerlink" href="#preparing-the-scene" title="Permalink to this headline">¶</a></h2>
<p>Create a new scene and drop in a Dungeon Snap game object.  This will allow you to build snap dungeons</p>
<div class="figure align-center">
<img alt="_images/prepare_scene_01.png" src="_images/prepare_scene_01.png" />
</div>
</div>
<div class="section" id="creating-module-prefabs">
<h2>Creating Module Prefabs<a class="headerlink" href="#creating-module-prefabs" title="Permalink to this headline">¶</a></h2>
<p>A module is a prebuilt prefab of a area (like room, corridor etc)</p>
<p>Design a room in the editor so we can turn it into a prefab for use with the snap builder</p>
<div class="figure align-center">
<img alt="_images/build_module_01.jpg" src="_images/build_module_01.jpg" />
</div>
<p>We’ve left holes at places where we want a possible door.   We’ll place a special Connection prefab later at these places to let Dungeon Architect know that it can stitch the rooms from these points</p>
<p>Go ahead and create a few more module prefabs. We’ve created one for a corridor below</p>
<div class="figure align-center">
<img alt="_images/build_module_02.jpg" src="_images/build_module_02.jpg" />
</div>
</div>
<div class="section" id="connections">
<h2>Connections<a class="headerlink" href="#connections" title="Permalink to this headline">¶</a></h2>
<p>A Snap Connection tells DA how to stitch the room modules together.  They are usually the Door Entry / Exits.</p>
<p>The connection also contains references to two assets, a references to a Door prefab and a reference to a Wall prefab.</p>
<p>If DA stitches another module through that connection point, it would place the specified Door prefab in that place. Otherwise it would fill up the gap with the specified Wall prefab</p>
<p>Design a new Connection prefab by creating an emtpy Game Object</p>
<div class="figure align-center">
<img alt="_images/connection_01.png" src="_images/connection_01.png" />
</div>
<p>Reset the transform of the newly created emtpy Game Object and rename it</p>
<div class="figure align-center">
<img alt="_images/connection_02.png" src="_images/connection_02.png" />
</div>
<p>Add a SnapConnection script to it</p>
<div class="figure align-center">
<img alt="_images/connection_03.png" src="_images/connection_03.png" />
</div>
<p>This script takes references to the above two mentioned prefab references, one for door and another for wall</p>
<p>Drop your Door and Wall prefabs under the Connection prefab</p>
<div class="figure align-center">
<img alt="_images/connection_04.png" src="_images/connection_04.png" />
</div>
<p>Align the door and wall prefabs so the Red line is perpendicular to it</p>
<div class="figure align-center">
<img alt="_images/connection_05.png" src="_images/connection_05.png" />
</div>
<p>Now set these child door / wall prefab references on the SnapConnection script</p>
<div class="figure align-center">
<img alt="_images/connection_06.png" src="_images/connection_06.png" />
</div>
<p>Your connection is ready.  Turn this into a prefab so we can reuse this in our modules</p>
<div class="figure align-center">
<img alt="_images/connection_08.png" src="_images/connection_08.png" />
</div>
<p>Drag and drop the connection prefab on your previously generated modules. Make sure the red line points outwards from the opening</p>
<div class="figure align-center">
<img alt="_images/connection_09.jpg" src="_images/connection_09.jpg" />
</div>
<p>Make sure the red line is pointing outwards and is on the edge of the module bounds</p>
<div class="figure align-center">
<img alt="_images/connection_10.jpg" src="_images/connection_10.jpg" />
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is a good practice to design with the snap settings (Edit &gt; Snap Settings &gt; Snap All Axis)</p>
</div>
<p>Repeat by drag-dropping on all the door openings.   Do this for all the other modules as well (like the corridor module)</p>
<div class="figure align-center">
<img alt="_images/connection_11.jpg" src="_images/connection_11.jpg" />
</div>
<div class="figure align-center">
<img alt="_images/connection_12.jpg" src="_images/connection_12.jpg" />
</div>
<p>Save/Update your module prefab</p>
</div>
<div class="section" id="register-the-modules">
<h2>Register the Modules<a class="headerlink" href="#register-the-modules" title="Permalink to this headline">¶</a></h2>
<p>Register your modules in the DungeonSnap game object so Dungeon Architect can use it to build the dungeon</p>
<p>Inspect the DungeonSnap Game Object</p>
<div class="figure align-center">
<img alt="_images/register_mod_01.png" src="_images/register_mod_01.png" />
</div>
<p>Here we’ve registered the two modules and assigned a Category to them (e.g. Room, Corridor, TreasureRoom, MiniBoss, MainBoss, SpawnRoom, Exit etc).</p>
<p>You can have multiple module prefabs assigned to the same category.    These categories are used in the Dungeon Flow graph to design a procedural layout graph for your dungeon</p>
</div>
<div class="section" id="dungeon-flow">
<h2>Dungeon Flow<a class="headerlink" href="#dungeon-flow" title="Permalink to this headline">¶</a></h2>
<p>A Dungeon Flow graph allows you to control the layout of your dungeons using Graph Grammars.   You can generate interesting graphs with simple rules</p>
<p>Create a new Dungeon Flow Asset by right clicking on the Projects window. (This can also be done from the Create menu in the Projects window or Assets &gt; Create from the editor’s main menu)</p>
<div class="figure align-center">
<img alt="_images/flow_01.png" src="_images/flow_01.png" />
</div>
<div class="figure align-center">
<img alt="_images/flow_02.png" src="_images/flow_02.png" />
</div>
<p>Double click the asset to open the Dungeon Flow Editor. Doc this window in a large area</p>
<div class="figure align-center">
<img alt="_images/flow_03.png" src="_images/flow_03.png" />
</div>
<p>Add two new nodes <strong>Room</strong> and <strong>Corridor</strong>.  You can change the name of the nodes from the inspector window</p>
<p>These names map to the names you specified on the Module registration in the DungeonSnap game object</p>
<div class="figure align-center">
<img alt="_images/flow_04.png" src="_images/flow_04.png" />
</div>
<p>Select the <em>Start Rule</em> and on the RHS, delete the default T node and drop in a few Room nodes like this:</p>
<div class="figure align-center">
<img alt="_images/flow_05.png" src="_images/flow_05.png" />
</div>
<div class="figure align-center">
<img alt="_images/flow_06.png" src="_images/flow_06.png" />
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Cycles are not supported by the SnapMap builder</p>
</div>
<p>Execute the rule and see how the final graph is generated. You do this by clicking the Run icon on the Execution graph panel</p>
<div class="figure align-center">
<img alt="_images/flow_07.png" src="_images/flow_07.png" />
</div>
<div class="figure align-center">
<img alt="_images/flow_08.png" src="_images/flow_08.png" />
</div>
<p>We’d like to insert Corridors between the rooms.   Create another rule and give it a name (e.g. <em>Insert Corridors</em>)</p>
<div class="figure align-center">
<img alt="_images/flow_09.png" src="_images/flow_09.png" />
</div>
<p>On the LHS, we want to find a patterns where two rooms are connected to each other like this (Room -&gt; Room) and have it replaced with (Room -&gt; Corridor -&gt; Room)</p>
<p>The Graph Grammar will find a pattern you specify on the LHS and replace it with the one you specify on the RHS</p>
<p>The Indices on the nodes (e.g. Room:0, Room:1) are important that helps in correct mapping.   Since we properly specified 0 and 1 indices on the RHS, it knows the direction of the newly created links to the corridor.   This will be covered in detail in the full documentation soon</p>
<p>You control how your rules are run from the <strong>Execution Graph</strong>.  Drag drop your newly created <strong>Insert Corridor</strong> rule on to the execution graph and connect it after the <em>Start Rule</em>.</p>
<div class="figure align-center">
<img alt="_images/flow_10.png" src="_images/flow_10.png" />
</div>
<p>Select the newly placed node and from the details panel, change the execution mode to Iterate and set the count to 2 or 3 (This makes the rule run multiple times since the newly replaced Room nodes wont map with the adjacent older Room nodes by design and need to be run again)</p>
<div class="figure align-center">
<img alt="_images/flow_11.png" src="_images/flow_11.png" />
</div>
<p>Execute the grammar and you’ll now see corridors between your rooms</p>
<div class="figure align-center">
<img alt="_images/flow_12.png" src="_images/flow_12.png" />
</div>
<p>We will use this Dungeon Flow graph grammar to generate our snap dungeons</p>
</div>
<div class="section" id="generating-the-dungeon">
<h2>Generating the Dungeon<a class="headerlink" href="#generating-the-dungeon" title="Permalink to this headline">¶</a></h2>
<p>Assign the <strong>Dungeon Flow</strong> assets to the DungeonSnap game object</p>
<div class="figure align-center">
<img alt="_images/build_01.png" src="_images/build_01.png" />
</div>
<p>Hit <strong>Build Dungeon</strong>.  Randomize the seed and get different configurations that satisfy the layout graph you defined in the flow asset.  Change the Dungeon Flow graph and experiment further</p>
<div class="figure align-center">
<img alt="_images/build_02.jpg" src="_images/build_02.jpg" />
</div>
<p>Explore the Sample for a more complex and complete dungeon map with multi key-lock system, treasure rooms guarded by miniboss, exist guarded by a Boss room which requires a key to unlock</p>
<p>Location: <em>DungeonArchitect_SamplesDemoBuilder_SnapScenesDemoScene</em></p>
<div class="figure align-center">
<img alt="_images/sample_01.jpg" src="_images/sample_01.jpg" />
</div>
<div class="figure align-center">
<img alt="_images/sample_02.jpg" src="_images/sample_02.jpg" />
</div>
<div class="figure align-center">
<img alt="_images/sample_03.png" src="_images/sample_03.png" />
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="builder_grid.html" class="btn btn-neutral float-right" title="Grid Builder" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="builder_grid_flow.html" class="btn btn-neutral float-left" title="Grid Flow Builder" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Code Respawn

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>